<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>SafeGuard Dashboard</title>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }
    body {
      background: #050816;
      color: #e5e7eb;
      min-height: 100vh;
      padding: 20px;
    }
    .container {
      max-width: 1100px;
      margin: 0 auto;
    }
    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }
    .header-title {
      font-size: 1.8rem;
      font-weight: 700;
    }
    .header-subtitle {
      font-size: 0.9rem;
      color: #9ca3af;
      margin-top: 4px;
    }
    .badge {
      background: linear-gradient(135deg, #22c55e, #16a34a);
      padding: 6px 12px;
      border-radius: 999px;
      font-size: 0.8rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.06em;
    }
    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
      gap: 20px;
      margin-bottom: 20px;
    }
    .card {
      background: radial-gradient(circle at top left, rgba(56, 189, 248, 0.2), transparent),
                  radial-gradient(circle at bottom right, rgba(14, 165, 233, 0.2), transparent),
                  #020617;
      border-radius: 16px;
      padding: 18px;
      border: 1px solid rgba(148, 163, 184, 0.15);
      box-shadow: 0 18px 45px rgba(15, 23, 42, 0.9);
    }
    .card-header {
      margin-bottom: 12px;
    }
    .card-title {
      font-size: 1.1rem;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .card-subtitle {
      font-size: 0.85rem;
      color: #9ca3af;
      margin-top: 3px;
    }
    .field {
      margin-top: 10px;
      margin-bottom: 10px;
    }
    label {
      font-size: 0.85rem;
      color: #9ca3af;
      display: block;
      margin-bottom: 4px;
    }
    input {
      width: 100%;
      padding: 9px 11px;
      border-radius: 10px;
      border: 1px solid rgba(148, 163, 184, 0.5);
      background: rgba(15, 23, 42, 0.8);
      color: #e5e7eb;
      font-size: 0.9rem;
      outline: none;
    }
    input:focus {
      border-color: #38bdf8;
      box-shadow: 0 0 0 1px rgba(56, 189, 248, 0.5);
    }
    button {
      margin-top: 8px;
      padding: 8px 14px;
      border-radius: 999px;
      border: none;
      background: linear-gradient(135deg, #38bdf8, #0ea5e9);
      color: white;
      font-size: 0.9rem;
      font-weight: 600;
      cursor: pointer;
      transition: transform 0.08s ease, box-shadow 0.08s ease;
      box-shadow: 0 10px 25px rgba(56, 189, 248, 0.45);
    }
    button:hover {
      transform: translateY(-1px);
      box-shadow: 0 14px 32px rgba(56, 189, 248, 0.65);
    }
    button:active {
      transform: translateY(0px) scale(0.99);
      box-shadow: 0 8px 18px rgba(56, 189, 248, 0.4);
    }
    .risk-bar-wrapper {
      margin-top: 10px;
    }
    .risk-label-row {
      display: flex;
      justify-content: space-between;
      font-size: 0.8rem;
      margin-bottom: 4px;
      color: #9ca3af;
    }
    .risk-bar {
      width: 100%;
      height: 10px;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.85);
      overflow: hidden;
      border: 1px solid rgba(148, 163, 184, 0.5);
    }
    .risk-bar-fill {
      height: 100%;
      width: 0%;
      transition: width 0.4s ease;
    }
    .risk-low {
      background: linear-gradient(90deg, #22c55e, #16a34a);
    }
    .risk-medium {
      background: linear-gradient(90deg, #facc15, #eab308);
    }
    .risk-high {
      background: linear-gradient(90deg, #f97316, #ef4444);
    }
    .pill {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 4px 10px;
      border-radius: 999px;
      font-size: 0.75rem;
      margin: 2px;
      border: 1px solid rgba(148, 163, 184, 0.3);
      background: rgba(15, 23, 42, 0.8);
    }
    .pill-bad {
      border-color: rgba(248, 113, 113, 0.7);
      color: #fecaca;
    }
    .pill-good {
      border-color: rgba(52, 211, 153, 0.7);
      color: #bbf7d0;
    }
    .card-section-title {
      font-size: 0.85rem;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: #9ca3af;
      margin-top: 8px;
      margin-bottom: 4px;
    }
    .result-block {
      margin-top: 6px;
      padding: 8px;
      border-radius: 10px;
      background: rgba(15, 23, 42, 0.9);
      border: 1px solid rgba(148, 163, 184, 0.4);
      font-size: 0.85rem;
    }
    .result-title {
      font-weight: 600;
      margin-bottom: 4px;
    }
    .muted {
      color: #9ca3af;
    }
    .history-card {
      margin-top: 10px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.8rem;
      margin-top: 8px;
    }
    th, td {
      padding: 6px 8px;
      border-bottom: 1px solid rgba(30, 41, 59, 0.9);
      text-align: left;
    }
    th {
      font-weight: 500;
      color: #9ca3af;
    }
    tr:last-child td {
      border-bottom: none;
    }
    .tag-url {
      color: #38bdf8;
      font-weight: 500;
    }
    .tag-senha {
      color: #f97316;
      font-weight: 500;
    }
    .tag-risk-low {
      color: #4ade80;
    }
    .tag-risk-medium {
      color: #facc15;
    }
    .tag-risk-high {
      color: #fb7185;
    }
    @media (max-width: 640px) {
      .header {
        flex-direction: column;
        align-items: flex-start;
        gap: 10px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <header class="header">
      <div>
        <div class="header-title">SafeGuard Dashboard</div>
        <div class="header-subtitle">
          Monitoramento simples de <strong>links suspeitos</strong> e <strong>senhas comprometidas</strong>, com score de risco.
        </div>
      </div>
      <div class="badge">Projeto de Ciberseguran√ßa ¬∑ Demo Online</div>
    </header>

    <main>
      <section class="grid">
        <div class="card">
          <div class="card-header">
            <div class="card-title">üîó An√°lise de Links</div>
            <div class="card-subtitle">
              Verifica estrutura da URL, protocolo, disponibilidade e sinais comuns de phishing.
            </div>
          </div>
          <div class="field">
            <label for="urlInput">URL para an√°lise</label>
            <input id="urlInput" type="text" placeholder="Ex: https://banco-seguro123.com/login">
          </div>
          <button onclick="analisarURL()">Analisar link</button>
          <div class="risk-bar-wrapper">
            <div class="risk-label-row">
              <span>Score de risco</span>
              <span id="urlRiskLabel" class="muted">‚Äî</span>
            </div>
            <div class="risk-bar">
              <div id="urlRiskFill" class="risk-bar-fill risk-low"></div>
            </div>
          </div>
          <div class="result-block">
            <div class="result-title">Resumo</div>
            <div id="urlResumo" class="muted">Nenhuma URL analisada ainda.</div>
          </div>
          <div class="card-section-title">Sinais suspeitos</div>
          <div id="urlFlags"></div>
        </div>

        <div class="card">
          <div class="card-header">
            <div class="card-title">üîê Verifica√ß√£o de Senhas</div>
            <div class="card-subtitle">
              Checa se a senha j√° foi vazada e estima a for√ßa com base em boas pr√°ticas.
            </div>
          </div>
          <div class="field">
            <label for="pwdInput">Senha para verifica√ß√£o</label>
            <input id="pwdInput" type="password" placeholder="Digite uma senha de teste">
          </div>
          <button onclick="verificarSenha()">Verificar senha</button>
          <div class="risk-bar-wrapper">
            <div class="risk-label-row">
              <span>Score de risco</span>
              <span id="pwdRiskLabel" class="muted">‚Äî</span>
            </div>
            <div class="risk-bar">
              <div id="pwdRiskFill" class="risk-bar-fill risk-low"></div>
            </div>
          </div>
          <div class="result-block">
            <div class="result-title">For√ßa da senha</div>
            <div id="pwdForca" class="muted">Nenhuma senha analisada ainda.</div>
          </div>
          <div class="card-section-title">Status em vazamentos</div>
          <div id="pwdVazamentos" class="muted">‚Äî</div>
        </div>
      </section>

      <section class="card history-card">
        <div class="card-header">
          <div class="card-title">üìä Hist√≥rico de an√°lises (sess√£o atual)</div>
          <div class="card-subtitle">
            Itens mais recentes primeiro. √ötil para demonstra√ß√£o em apresenta√ß√£o da disciplina.
          </div>
        </div>
        <table>
          <thead>
            <tr>
              <th>Tipo</th>
              <th>Entrada</th>
              <th>Risco</th>
              <th>Score</th>
            </tr>
          </thead>
          <tbody id="historyBody">
            <tr>
              <td colspan="4" class="muted">Nenhuma an√°lise realizada ainda.</td>
            </tr>
          </tbody>
        </table>
      </section>
    </main>
  </div>

  <script>
    const API_BASE = "https://safeguard-gume.onrender.com";
    const historyItems = [];

    function atualizarHistory() {
      const tbody = document.getElementById("historyBody");
      tbody.innerHTML = "";
      if (historyItems.length === 0) {
        const tr = document.createElement("tr");
        const td = document.createElement("td");
        td.colSpan = 4;
        td.className = "muted";
        td.innerText = "Nenhuma an√°lise realizada ainda.";
        tr.appendChild(td);
        tbody.appendChild(tr);
        return;
      }
      historyItems.slice().reverse().forEach(item => {
        const tr = document.createElement("tr");
        const tdTipo = document.createElement("td");
        tdTipo.innerHTML = item.tipo === "url"
          ? '<span class="tag-url">URL</span>'
          : '<span class="tag-senha">Senha</span>';
        const tdEntrada = document.createElement("td");
        tdEntrada.innerText = item.valor;
        const tdNivel = document.createElement("td");
        let nivelClass = "tag-risk-low";
        if (item.risk_level === "M√©dio") nivelClass = "tag-risk-medium";
        if (item.risk_level === "Alto") nivelClass = "tag-risk-high";
        tdNivel.innerHTML = `<span class="${nivelClass}">${item.risk_level}</span>`;
        const tdScore = document.createElement("td");
        tdScore.innerText = item.risk_score + " / 100";
        tr.appendChild(tdTipo);
        tr.appendChild(tdEntrada);
        tr.appendChild(tdNivel);
        tr.appendChild(tdScore);
        tbody.appendChild(tr);
      });
    }

    function setRiskBar(elementFill, elementLabel, score, level) {
      elementFill.style.width = score + "%";
      elementLabel.innerText = `${level} (${score}/100)`;
      elementFill.classList.remove("risk-low", "risk-medium", "risk-high");
      if (level === "Baixo") {
        elementFill.classList.add("risk-low");
      } else if (level === "M√©dio") {
        elementFill.classList.add("risk-medium");
      } else {
        elementFill.classList.add("risk-high");
      }
    }

    async function analisarURL() {
      const urlInput = document.getElementById("urlInput");
      const resumo = document.getElementById("urlResumo");
      const flagsContainer = document.getElementById("urlFlags");
      const riskFill = document.getElementById("urlRiskFill");
      const riskLabel = document.getElementById("urlRiskLabel");

      const url = urlInput.value.trim();
      if (!url) {
        resumo.innerText = "Digite uma URL para analisar.";
        return;
      }

      resumo.innerText = "Analisando URL...";
      flagsContainer.innerHTML = "";

      try {
        const resp = await fetch(API_BASE + "/analisa-url", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ url })
        });
        if (!resp.ok) {
          resumo.innerText = "Erro ao consultar API. Verifique se a API do Render est√° ativa.";
          return;
        }
        const data = await resp.json();
        let partesResumo = [];
        partesResumo.push(data.valida ? "URL v√°lida." : "URL inv√°lida.");
        partesResumo.push(data.usa_https ? "Usa HTTPS." : "N√£o usa HTTPS.");
        partesResumo.push(data.online ? "Site responde." : "Site n√£o respondeu.");
        resumo.innerText = partesResumo.join(" ");

        if (data.sinais_suspeitos && data.sinais_suspeitos.length > 0) {
          data.sinais_suspeitos.forEach(s => {
            const pill = document.createElement("span");
            pill.className = "pill pill-bad";
            pill.innerText = s;
            flagsContainer.appendChild(pill);
          });
        } else {
          const pill = document.createElement("span");
          pill.className = "pill pill-good";
          pill.innerText = "Nenhum sinal suspeito b√°sico detectado.";
          flagsContainer.appendChild(pill);
        }

        setRiskBar(riskFill, riskLabel, data.risk_score, data.risk_level);
        historyItems.push({ tipo: "url", valor: data.url, risk_score: data.risk_score, risk_level: data.risk_level });
        atualizarHistory();
      } catch (err) {
        console.error(err);
        resumo.innerText = "Erro de conex√£o com o backend.";
      }
    }

    async function verificarSenha() {
      const pwdInput = document.getElementById("pwdInput");
      const forca = document.getElementById("pwdForca");
      const vazamentos = document.getElementById("pwdVazamentos");
      const riskFill = document.getElementById("pwdRiskFill");
      const riskLabel = document.getElementById("pwdRiskLabel");

      const password = pwdInput.value;
      if (!password) {
        forca.innerText = "Digite uma senha para analisar (preferencialmente uma senha de teste).";
        return;
      }

      forca.innerText = "Analisando senha...";
      vazamentos.innerText = "Consultando base de vazamentos...";

      try {
        const resp = await fetch(API_BASE + "/verifica-senha", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ password })
        });
        if (!resp.ok) {
          forca.innerText = "Erro ao consultar API. Verifique se a API do Render est√° ativa.";
          vazamentos.innerText = "‚Äî";
          return;
        }
        const data = await resp.json();
        forca.innerText = `For√ßa: ${data.forca_nivel} (${data.forca_score}/100).`;
        if (data.comprometida) {
          vazamentos.innerText = `‚ùå Essa senha j√° apareceu em vazamentos ${data.ocorrencias} vezes. Troque imediatamente e n√£o reutilize.`;
        } else {
          vazamentos.innerText = "‚úÖ Essa senha n√£o foi encontrada na base consultada. Ainda assim, use sempre boas pr√°ticas (tamanho, complexidade e 2FA).";
        }
        setRiskBar(riskFill, riskLabel, data.risk_score, data.risk_level);
        historyItems.push({ tipo: "senha", valor: "‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢", risk_score: data.risk_score, risk_level: data.risk_level });
        atualizarHistory();
      } catch (err) {
        console.error(err);
        forca.innerText = "Erro de conex√£o com o backend.";
        vazamentos.innerText = "‚Äî";
      }
    }
  </script>
</body>
</html>
